# Fail2Ban configuration file
#
# XDPDropper action to add or remove clients via eBPF XDP
#
# Author: Jack Coleman <alphajack at tuta dot io>
# Date: 2023-08-11
# Info: https://github.com/renanqts/xdpdropper 

[Init]
# protocol used to reach the xdpdropper instance (http or https)
xdpd_scheme = http

# address of the xdpdropper instance
xdpd_host = 127.0.0.1

# port of the xdpdropper instance
xdpd_port = 8080

[Definition]
actionstart =
actionstop  =
actioncheck = curl -s <xdpd_scheme>://<xdpd_host>:<xdpd_port>/health
actionban   = curl -s -d '{"ip":"<ip>"}' -X POST -H "Content-Type: application/json" <xdpd_scheme>://<xdpd_host>:<xdpd_port>/drop
actionunban = curl -s -d '{"ip":"<ip>"}' -X DELETE -H "Content-Type: application/json" <xdpd_scheme>://<xdpd_host>:<xdpd_port>/drop
