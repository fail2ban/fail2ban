# Fail2Ban apache-badpath filter

[INCLUDES]

before = apache-common.conf

[Definition]
 
badagents = 360Spider|ZmEu|Auto Spider 1.0|zgrab/[0-9]*\.[0-9a-zA-Z]*|Wget\(.*\)|MauiBot.*|AspiegelBot.*|SemrushBot.*|PHP/.*
 
failregex = ^<HOST> -.*"(GET|POST|HEAD).*HTTP.*(?:%(badagents)s)"$
            ^<HOST> -.*"(GET|POST|HEAD) /*[pP][hH][pP][mM][yY][aA][dD][mM][iI][nN].*$
            ^<HOST> -.*"(GET|POST|HEAD) /.git/HEAD.*$
            ^<HOST> -.*"(GET|POST|HEAD) /+.env.*$
            ^<HOST> -.*"(GET|POST|HEAD) /lib.php.*$
            ^<HOST> -.*"(GET|POST|HEAD) /wls-wsat.*$
            ^<HOST> -.*"(GET|POST|HEAD) /+wp-config\.php.*$
            ^<HOST> -.*"(GET|POST|HEAD) /+wp-content.*$
            ^<HOST> -.*"(GET|POST|HEAD) /+wp-includes.*$
            ^<HOST> -.*"(GET|POST|HEAD) /+wp-login\.php.*$
            ^<HOST> -.*"(GET|POST|HEAD) /wp-login.php.*$
            ^<HOST> -.*"(GET|POST|HEAD) /wuwu11\.php.*$
            ^<HOST> -.*"(GET|POST|HEAD) /wwwroot\.rar.*$
            ^<HOST> -.*"(GET|POST|HEAD) http:.*/[pP][hH][pP][mM][yY][aA][dD][mM][iI][nN].*$
 
ignoreregex =

datepattern = ^[^\[]*\[({DATE})
              {^LN-BEG}

# DEV Notes:
# Filter to ban known (and unwanted) access attempts.
# This filter is for Apache access.log
# Credits: original work from Jay Ta'ala <https://confluence.jaytaala.com/display/TKB/Implement+fail2ban+with+custom+apache+filter%2C+ipset%2C+and+a+sample+based+verification+approach>
#
# Author: Jacques Deguest
