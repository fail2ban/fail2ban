# Fail2Ban filter for Anti-Spam SMTP Proxy Server also known as ASSP
# 
#    Homepage:   http://sourceforge.net/projects/assp/
#    ProjectSite: http://sourceforge.net/projects/assp/?source=directory
#
#

[Definition] 

failregex = ^ \[RelayAttempt\] <HOST> \<\S+@\S+\.\S+\> relay attempt blocked for: \S+$
			^ <HOST> \[SMTP Error\] 535 5\.7\.8 Error: authentication failed: authentication failure$
		
ignoreregex = 

# DEV Notes:
#
# Update Notes:
# * For use with ASSP2.
# * All Timestamps must use "DD-MM-YYYY hh:mm:ss" within ASSP, this can be found in the logging options in ASSP (#LogDateFormat).
# * Must also disable unique message ids. 
# * Should disable logging of message content. 
# * ASSP Homepage has been down for a while, falling back the Source Forge's project page
# * Fixed spelling
# * Removed out of date? Regex. 
#
# Examples: 
# On my server I get the same addresses attempting to relay over and over. I don't understand why. 
#               18-06-2014 11:20:33 [RelayAttempt] 0.0.0.0 <user@example.com> relay attempt blocked for: user@example.org 
# Basic bruteforce attempt 
#               18-06-2014 11:20:33 0.0.0.0 [SMTP Error] 535 5.7.8 Error: authentication failed: authentication failure 

# Author: Enrico Labedzki (enrico.labedzki@deiwos.de)
# Updated: Mark Lopez (m@silvenga.com)


