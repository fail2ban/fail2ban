# Fail2Ban filter for courier authentication failures
#
# Courier mail transfer agent (MTA) is an integrated mail/groupware server based on open commodity protocols, 
# such as ESMTP, IMAP, POP3, LDAP, TLS, and HTTP. Courier provides ESMTP, IMAP, POP3, webmail, and mailing list 
# services within a single, consistent, framework.
# 
# Homepage:   http://www.courier-mta.org
# Repository: http://www.courier-mta.org/repo.html
# License:    GNU General Public
# Developer:  Double Precision, Inc.
# Wikipedia:  https://en.wikipedia.org/wiki/Courier_Mail_Server

[INCLUDES]

# Read common prefixes. If any customizations available -- read them from
# common.local
before = common.conf

[Definition]

_daemon = (?:courier)?(?:imapd?|pop3d?)(?:login)?(?:-ssl)?

failregex = ^%(__prefix_line)sLOGIN FAILED, (?:(?!ip=)(?:user=<F-USER>[^,]*</F-USER>|\w+=[^,]*), )*ip=\[<HOST>\]

ignoreregex = 

datepattern = {^LN-BEG}

# Author: Christoph Haas
# Modified by: Cyril Jaquier
