# Author: Tom Hendrikx, modifications by LearningSpot
# Fail2Ban filter for cs-cloudflare bans
#
# This filter monitors the fail2ban log file, and enables you to add ip addresses that get banned by fail2ban to cloudflare.
#
[INCLUDES]
before = common.conf
[Definition]
_daemon = (?:fail2ban(?:-server|\.actions)\s*)
# The name of the jail that this filter is used for. In jail.conf, name the jail using
# this filter 'cs-cloudflare', or supply another name with `filter = cs-cloudflare[_jailname="jail"]`
_jailname = cs-cloudflare
failregex = ^%(__prefix_line)s(?:\s*fail2ban\.actions\s*%(__pid_re)s?:\s+)?NOTICE\s+\[(?!%(_jailname)s\])(?:.*)\]\s+Ban\s+<HOST>\s*$
datepattern = ^{DATE}
ignoreregex =
journalmatch = _SYSTEMD_UNIT=fail2ban.service PRIORITY=5
