# fail2ban filter configuration for nginx


[Definition]


failregex = ^ \[error\] \d+#\d+: \*\d+ user \S+:? (password mismatch(: .*)?|(was )?not found(:| in) .*), client: <HOST>, server: \S*, request: "\S+ \S+ HTTP/\d+\.\d+", host: "\S+"(, referrer: "\S+")?\s*$
            ^ \[error\] \d+#\d+: \*\d+ client used invalid token: .*, client: <HOST>, server: \S*, request: "\S+ \S+ HTTP/\d+\.\d+", host: "\S+"(, referrer: "\S+")?\s*$

ignoreregex = 

datepattern = {^LN-BEG}

# DEV NOTES:
# Based on samples in https://github.com/fail2ban/fail2ban/pull/43/files
# Extensive search of all nginx auth failures not done yet.
# 
# Author: Daniel Black
#
# Also follows these default web application patterns :
# (https://github.com/fail2ban/fail2ban/issues/1642)
# user "bob" not found: My Protected Web Application
# user "bob" password mismatch: My Protected Web Application
# client used invalid token: My Protected Web Application
