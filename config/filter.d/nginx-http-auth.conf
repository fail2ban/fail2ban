# fail2ban filter configuration for nginx


[Definition]

extendregex = 

failregex = ^ \[error\] \d+#\d+: \*\d+ user "\S+":? (password mismatch|was not found in ".*"), client: <HOST>, server: \S*, request: "\S+ \S+ HTTP/\d+\.\d+", host: "\S+"(, referrer: "\S+")?\s*$
            %(extendregex)s

ignoreregex = 

protect_web_apps = ^ \[error\] \d+#\d+: \*\d+ user \S* ?(not found|not authorized|password mismatch|sent invalid token|misbehaved): .+, client: <HOST>, server: \S*, request: "\S+ \S+ HTTP/\d+\.\d+", host: "\S+"(, referrer: "\S+")?\s*$

datepattern = {^LN-BEG}

# DEV NOTES:
#
# Based on samples in https://github.com/fail2ban/fail2ban/pull/43/files
# Extensive search of all nginx auth failures not done yet.
#
# Also contains default message patterns to protect web apps
# See: https://github.com/fail2ban/fail2ban/issues/1642
#
# Author: Daniel Black
