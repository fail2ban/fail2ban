# fail2ban filter configuration for nginx


[Definition]

prefregex = ^\s*\[error\] \d+#\d+: \*\d+ <F-CONTENT>.+</F-CONTENT>$
failregex = ^user "\S+":? (password mismatch|was not found in "\S+"), client: <HOST>
            %(extfailregex)s

ignoreregex = 

none =
extension = none
extfailregex = <<extension>>

# Failregex extension to protect web apps with default message patterns:
# Usage:
#
#   filter = nginx-http-auth[extension=protect-web-apps]
#
protect-web-apps = ^user \S* ?(not found|not authorized|password mismatch|sent invalid token|misbehaved|tried to break-in): [^,]+, client: <HOST>

datepattern = {^LN-BEG}

# DEV NOTES:
#
# Based on samples in https://github.com/fail2ban/fail2ban/pull/43/files
# Extensive search of all nginx auth failures not done yet.
#
# Also contains default message patterns to protect web apps
# See: https://github.com/fail2ban/fail2ban/issues/1642
#
# Author: Daniel Black
