## NextCloud brute force auth filter /etc/fail2ban/filter.d/nextcloud.conf
## ----------------------------------------------------------------------------------
## When use this filter, you need to set log file located in nextcloud/data directory.
## -----------------------------------------------------------------------------------
## Tested ot current stable version 16.0.5

[Definition]
failregex=^{"reqId":".*","remoteAddr":".*","app":"core","message":"Login failed: '.*' \(Remote IP: '<HOST>'\)","level":2,"time":".*"}$
            ^{"reqId":".*","level":2,"time":".*","remoteAddr":".*","app":"core".*","message":"Login failed: '.*' \(Remote IP: '<HOST>'\)".*}$
            ^.*\"remoteAddr\":\"<HOST>\".*Trusted domain error.*$
