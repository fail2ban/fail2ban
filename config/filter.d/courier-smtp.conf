# Fail2Ban filter to block relay attempts though a Courier smtp server
#
# Courier mail transfer agent (MTA) is an integrated mail/groupware server based on open commodity protocols, 
# such as ESMTP, IMAP, POP3, LDAP, TLS, and HTTP. Courier provides ESMTP, IMAP, POP3, webmail, and mailing list 
# services within a single, consistent, framework.
# 
# Homepage:   http://www.courier-mta.org
# Repository: http://www.courier-mta.org/repo.html
# License:    GNU General Public
# Developer:  Double Precision, Inc.
# Wikipedia:  https://en.wikipedia.org/wiki/Courier_Mail_Server

[INCLUDES]

# Read common prefixes. If any customizations available -- read them from
# common.local
before = common.conf

[Definition]

_daemon = courieresmtpd

prefregex = ^%(__prefix_line)serror,relay=<HOST>,(?:port=\d+,)?<F-CONTENT>.+</F-CONTENT>$

failregex = ^[^:]*: 550 User (<.*> )?unknown\.?$
            ^msg="535 Authentication failed\.",cmd:( AUTH \S+)?( [0-9a-zA-Z\+/=]+)?(?: \S+)$

ignoreregex = 

# Author: Cyril Jaquier
