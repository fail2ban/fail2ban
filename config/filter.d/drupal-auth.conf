# Fail2Ban filter to block repeated failed login attempts to Drupal site(s)
#
# Requirements: 
#     1. Configure Drupal Syslog using this documentation at https://www.drupal.org/documentation/modules/syslog
#
#     2. Setup Drupal appropriately to use Syslog. Per documentation above. With this Syslog defaults format:
#          !base_url|!timestamp|!type|!ip|!request_uri|!referer|!uid|!link|!message
#
# Drupal is a free and open source content-management framework written in PHP. 
# As of September 2018, the Drupal community is composed of more than 1.3 million members.
# Drupal provides a back-end framework for web sites ranging from personal blogs to corporate, 
# political, and government sites. Systems also use Drupal for knowledge management 
# and for business collaboration.
# 
# Homepage:   https://www.drupal.org
# Repository: http://cgit.drupalcode.org/drupal
# License:    GPLv2 or later
# Developer:  Drupal community. With fostering and support by the Drupal Association.
# Wikipedia:  https://en.wikipedia.org/wiki/Drupal

[INCLUDES]

before = common.conf


[Definition]

failregex = ^%(__prefix_line)s(https?:\/\/)([\da-z\.-]+)\.([a-z\.]{2,6})(\/[\w\.-]+)*\|\d{10}\|user\|<HOST>\|.+\|.+\|\d\|.*\|Login attempt failed for .+\.$

ignoreregex =

# Original author drupal-auth.conf: Lee Clemens
