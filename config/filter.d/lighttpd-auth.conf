# Fail2Ban filter to match wrong passwords as notified by lighttpd's auth Module
#

[Definition]

failregex = ^: \(http_auth\.c\.\d+\) (password doesn\'t match .* username: .*|digest: auth failed for .*: wrong password|get_password failed), IP: <HOST>\s*$
            %(extfailregex)s

ignoreregex = 


none =
extension = none
extfailregex = <<extension>>

# Failregex extension to protect web apps with default message patterns:
# Usage:
#
#   filter = lighttpd-auth[extension=protect-web-apps]
#
protect-web-apps = ^: \(\S+\.c\.\d+\) user \S* ?(not found|not authorized|password mismatch|sent invalid token|misbehaved|tried to break-in)\b.*, IP: <HOST>\s*$

# DEV NOTES:
#
# Also contains default message patterns to protect web apps
# See: https://github.com/fail2ban/fail2ban/issues/1642
#
# Author: Francois Boulogne <fboulogne@april.org>
