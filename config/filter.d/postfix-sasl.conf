# Fail2Ban filter for postfix authentication failures
#
# 04.07.2014: Pixinger77 modified regex because of undetected log message, where "LOGIN" was written in lower case as "login" - CentOS6.
#             org: FAILREGEX = ^%(__prefix_line)swarning: [-._\w]+\[<HOST>\]: SASL (?:LOGIN|PLAIN|(?:CRAM|DIGEST)-MD5) authentication failed(: [ A-Za-z0-9+/]*={0,2})?\s*$
#             mod: FAILREGEX = ^%(__prefix_line)swarning: [-._\w]+\[<HOST>\]: SASL \S+ authentication failed(: [ A-Za-z0-9+/]*={0,2})?\s*$

[INCLUDES]

before = common.conf

[Definition]

_daemon = postfix/smtpd

FAILREGEX = ^%(__prefix_line)swarning: [-._\w]+\[<HOST>\]: SASL \S+ authentication failed(: [ A-Za-z0-9+/]*={0,2})?\s*$

# Author: Yaroslav Halchenko
