# Fail2Ban filter to match web requests for selected URLs that don't exist
# using the standard logging format for the CMS Drupal. This filter is
# necessary because these events are not captured in regular web server
# (Apache, nginx, etc.) logs when Drupal is installed and using Syslog.
#
#
# Drupal must be setup to use Syslog, which defaults to the following format:
#
#   !base_url|!timestamp|!type|!ip|!request_uri|!referer|!uid|!link
#
#

[INCLUDES]

before = common.conf
         botsearch-common.conf


[Definition]

failregex = ^%(__prefix_line)s(https?:\/\/)([\da-z\.-]+)\.([a-z\.]{2,6})(\/[\w\.-]+)*\|\d{10}\|page not found\|<HOST>\|(https?:\/\/)([\da-z\.-]+)\.([a-z\.]{2,6})\/<block>\|.*\|\d\|.*\|.+$

ignoreregex =


# DEV Notes:
#
# https://www.drupal.org/documentation/modules/syslog
#
# Author: Chris Wells
