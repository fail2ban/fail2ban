# fail2ban filter configuration for ufw blocked events (typically port scans)
#
# By default every connection attempt blocked by ufw will be
# logged, e.g.:
#
# Sep 14 20:56:41 sierra kernel: [UFW BLOCK] [...] SRC=<REDACTED> DST=<REDACTED> LEN=40 TOS=0x04 PREC=0x00 TTL=48 ID=5614 PROTO=TCP SPT=34092 DPT=23 WINDOW=43012 RES=0x00 SYN URGP=0
#
# By carefully setting this filter we ban every IP that tries too many times to
# connect to non-allowed ports.
#
# Author: Michele Bologna https://www.michelebologna.net/

[Definition]
failregex = ^\s*\S+ kernel:(?: +\[[^\]]+\])? \[UFW (?:LIMIT )?BLOCK\] (?:\b(?:IN=\w+|OUT=|(?:(?!OUT=|IN=)[A-Z]+=[^ \[]*)+) )*SRC=<ADDR> DST=\S+
ignoreregex =
