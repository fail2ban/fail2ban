# Fail2Ban filter for:
# - Bruteforce attacks (e.g.: phpmyadmin, mysql, pma, xampp)
# - Port scanners
# - Vulnerability scanners
# - PHP, CGI exploiters
# - Shellshock
#
# -------------------------------------------------------
# HOW TO APPLY THIS RULE: JAIL.LOCAL
#
# make sure to use a smaller name, so you don't exceed the limit
# [apache-zerotol]
#
# enabled  = true
# port     = all
# port     = http,https,ssh
# filter   = apache-zerotolerance
# banaction = iptables-allports
# logpath  = /var/log/apache*/*access*.log
# maxretry = 0 #zero retries, so the ip gets blocked immediately
#
# -------------------------------------------------------
#

[Definition]

failregex = ^<HOST> -.*\"(GET|POST)\s*(\/admin)?\/(php)?((m|M)y(sql)?|db)?((a|A)dmin\d?)?\/scripts\/(s|S)etup\d*\.php\s*HTTP.*404.*$
            ^<HOST> -.*\"(GET|POST)\s*\/xampp\/phpmyadmin\/scripts\/setup\.php\s*HTTP.*404.*$
            ^<HOST> -.*\"(GET|POST)\s*(\/)+(admin\/)?pma\/scripts\/setup\.php\s*HTTP.*404.*$
            ^<HOST> -.*\"(GET|POST)\s*(\/)+mysql\/scripts\/setup\.php\s*HTTP.*404.*$
            ^<HOST> -.*\"(GET|POST)\s*(\/)+((m|M)y)?(sql)?(a|A)dmin(db)?\/scripts\/setup\.php\s*HTTP.*404.*$
            ^<HOST> -.*\"(GET|POST)\s*(\/)+scripts\/setup\.php\s*HTTP.*404.*$
            ^<HOST> -.*\"(GET|POST)\s*(\/)+db(admin)?\/scripts\/setup\.php\s*HTTP.*404.*$
            ^<HOST> -.*\"(GET|POST).*\"sysscan\/.*\s*.*robertdavidgraham\/sysscan.*$
            ^<HOST> -.*\"(GET|POST).*HTTP.*\"masscan\/\d*\.*\d*\"\s*$
            ^<HOST> -.*\"(GET|POST|HEAD).*HTTP.*\"Mozilla\/\d*\.*\d*\s*Jorgee\"\s*$
            ^<HOST> -.*\"(GET|POST)\s*\/shell\?(%%[0-9a-fA-F]+\/?)*\s*HTTP.*$
            ^<HOST> -.*\"(GET|POST).*HTTP.*\"\-\"\s*\"\(\)\s*\{\s*\:\;\}\;.*$
            ^<HOST> -.*\"(GET|POST)\s*\/w00tw00t\.at\.ISC\.SANS\.DFind.*HTTP.*$
            ^<HOST> -.*\"(GET|POST|HEAD)\s*.*\:\d+<(\/)?(html|head|title|h1|p|hr|address|body)>.*\s*HTTP(\/(\d)+(\.)?(\d)?).*$
            ^<HOST> -.*\"(GET|POST)\s+\/(hnd|tm)Unblock.cgi\s*HTTP(\/(\d)+(\.)?(\d)?)\"\s+404.*$$
            ^<HOST> -.*\"(GET|POST)\s*(\/)+muieblackcat\s*HTTP(\/(\d)+(\.)?(\d)?).*404.*$
            ^<HOST> -.*\"(GET|POST)\s*(\/)+cgi\-sys\/entropysearch\.cgi\s*HTTP(\/(\d)+(\.)?(\d)?).*404.*$

ignoreregex =

# DEV Notes:
#
# Author: Rafael Alves (https://github.com/rafaces)
