# Fail2Ban configuration file for generic Selinux Errors authentication errors
#
# Author: Daniel Black
#
#
[Definition]

_type = USER_(LOGIN|ERR|AUTH)
_uid  = 0
_auid = \d+
_subj = (?:unconfined_u|system_u):system_r:sshd_t:s0-s0:c0\.c1023

_exe  =/usr/sbin/sshd
_terminal = ssh

_msg = op=\S+ acct=(?P<_quote_acct>"?)\S+(?P=_quote_acct) exe="%(_exe)s" hostname=(\?|(\d+\.){3}\d+) addr=<HOST> terminal=%(_terminal)s res=failed

failregex = ^type=%(_type)s msg=audit\(:\d+\): user pid=\d+ uid=%(_uid)s auid=%(_auid)s ses=\d+ subj=%(_subj)s msg='%(_msg)s'$

