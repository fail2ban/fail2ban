# Fail2Ban filter for obnoxious SMTP client behavior
#
# Gets rid of connections with no other actions.  Take care of repeated
# spammers and relayers along with your RBL.
#

[INCLUDES]

before = common.conf

[Definition]

_daemon = (?:sendmail|sm-(mta|acceptingconnections))

failregex = ^%(__prefix_line)s\w{14}: (\S+ )?\[<HOST>\] did not issue MAIL/EXPN/VRFY/ETRN during connection to (TLS)?MTA-v[4,6]$
            ^%(__prefix_line)s\w{14}: ruleset=check_rcpt, arg1=<\w+@\S+>, relay=(\S+ )?\[<HOST>\], reject=55[0,4] 5\.7\.1

ignoreregex =

[Init]

journalmatch = _SYSTEMD_UNIT=sendmail.service

# DEV Notes:
#
# Author: Daniel L. Srebnick (aka K2DLS) 
